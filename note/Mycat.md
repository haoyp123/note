## 一、mycat

#### 1.数据库的优化

1. 主从--》实现高可用，读写分离。
2. 分片--》将完整数据拆分不同部分，达到分散存储和访问。
3. 分库：应用拆分、模块拆分的必然结果。分表：解决单张表的性能。

#### 2.分库分表

1. 分表

   - 垂直分表——》单张表数据过多。

     将一个表字段按规则分成多张表如商品表和商品属性表。

   - 水平分表——》将同一张表的数据按照一定规则水平拆分到多张表中。
   
2. 分库

   - 垂直分库——》按业务分到不同的库，专库专用
   - 水平分库——》将同一个库的内容分到两个库存储。

3. 出现的问题。

   - 分布式事务问题
     - 全局事务。两段式提交XA。
- 基于可靠消息的分布式事务。
     - 柔性事务。TCC try confirm cancel
     
   - 跨节点的join查询。
     - 数据组装。service层分两次查询 一般是这种。
     - 适当冗余。用户姓名和用户id放在一起。
  - 全局表。
     - 放在同一切片。减少跨库
   
   - 水平分表——》全局唯一ID问题
     - 分布式ID生成器。雪花算法、UUID、redis 自增等等。
     - 分布式锁应用场景

`